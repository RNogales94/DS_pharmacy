<!doctype html>
<html lang="es">
	<head>
		<meta charset="utf-8">
		<title>Base de datos</title>
		<meta name="author" content="Luis Castro MartÃ­n">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="google-signin-client_id" content="769660523126-rr6dgql0csb22pepveociq5gt8nkrlqe.apps.googleusercontent.com">
		<link rel="icon" href="https://luiscastro193.github.io/base-de-datos/public/favicon.ico">
		<link rel="stylesheet" type="text/css" href="https://luiscastro193.github.io/base-de-datos/public/styles.css">
		<script src="https://apis.google.com/js/platform.js" async defer></script>
		<script src="https://luiscastro193.github.io/base-de-datos/public/api.js"></script>
	</head>

	<body>
		<div class="g-signin2" data-onsuccess="loadUser" data-prompt="select_account"></div>
		<main></main>
		<script>
			"use strict";
			if (location.protocol == 'http:') location.protocol = 'https:';

			function clearUser() {
				gapi.auth2.getAuthInstance().signOut();
				document.querySelector('main').innerHTML = '';
			}

			function loadUser() {
				let main = document.querySelector('main');
				main.innerHTML = '';

				get("/username", true).then(username => {
					main.innerHTML = `<p>Bienvenido,</p>
					<p>${username}</p>
					<a href="javascript:void(0)" onclick="clearUser()">Sign out</a>`;
				}).catch(errorHandler);
			}
		</script>
	</body>
</html>
